<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        body {
            background-image: url("{% static 'myapp/image/bg.svg' %}");
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            min-height: 100vh;
            width: 100%;
        }
        @media (max-width: 425px) {
            body {
                background-image: url("{% static 'myapp/image/Desain-tanpa-judul-_1_.svg' %}");
            }
        }
    </style>
    <title>Halaman Pendaftaran</title>
</head>
<body class="flex flex-col items-center justify-center text-white min-h-screen">
<h2 class="absolute top-20 sm:top-12 w-full text-center text-3xl sm:text-4xl font-bold text-white mb-4">
        Daftar
    </h2>
    <div class="bg-white bg-opacity-10 backdrop-blur-lg rounded-lg shadow-lg w-full max-w-md p-8">
        <form method="POST" onsubmit="return validateForm(event)">
    <div>
        <label for="username" class="block text-sm font-medium">Nama Pengguna</label>
        <input id="username" type="text" name="username" placeholder="Nama Pengguna" required
            class="mt-1 w-full p-2 rounded-md bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
    </div>
    <div>
        <label for="email" class="block text-sm font-medium">Alamat Email</label>
        <input id="email" type="email" name="email" placeholder="Alamat Email" required
            class="mt-1 w-full p-2 rounded-md bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
        <p id="email-error" class="text-red-500 text-sm hidden">Gunakan Email Teknik Komputer Undip</p>
    </div>
    <div>
        <label for="password" class="block text-sm font-medium">Kata Sandi</label>
        <input id="password" type="password" name="password" placeholder="Kata Sandi" required minlength="8"
            class="mt-1 w-full p-2 rounded-md bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
        <p id="password-error" class="text-red-500 text-sm hidden">Password minimal 8 karakter</p>
    </div>
    <div>
        <label for="phone" class="block text-sm font-medium">Nomor Handphone</label>
        <input id="phone" type="tel" name="phone" placeholder="Masukkan Nomor Handphone" required maxlength="12"
            class="mt-1 w-full p-2 rounded-md bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
            oninput="validatePhone(this)">
        <p id="phone-error" class="text-red-500 text-sm hidden">Nomor Handphone hanya boleh angka (max 12 digit)</p>
    </div>
    <button type="submit"
        class="mt-4 w-full bg-blue-500 text-white p-2 rounded-md hover:bg-blue-600 transition">Daftar</button>
</form>

<!-- Pesan sukses -->
<div id="success-message" class="hidden mt-4 p-4 bg-green-500 text-white text-center rounded-md">
    Akun berhasil dibuat! Anda akan segera dialihkan...
</div>

<script>
    function validatePhone(input) {
        input.value = input.value.replace(/[^0-9]/g, '').slice(0, 12);
        document.getElementById('phone-error').classList.toggle('hidden', input.value.length > 0);
    }

    function validateForm(event) {
        const emailField = document.getElementById("email");
        const emailError = document.getElementById("email-error");
        const passwordField = document.getElementById("password");
        const passwordError = document.getElementById("password-error");
        const phoneField = document.getElementById("phone");
        const phoneError = document.getElementById("phone-error");

        const emailPattern = /^[a-zA-Z0-9._%+-]+@student\.ce\.undip\.ac\.id$/;
        const isValidEmail = emailPattern.test(emailField.value);
        emailError.classList.toggle("hidden", isValidEmail);

        const isValidPassword = passwordField.value.length >= 8;
        passwordError.classList.toggle("hidden", isValidPassword);

        if (!isValidEmail || !isValidPassword) {
            event.preventDefault(); // Stop form submission jika ada kesalahan
            return false;
        }

        if (phoneField.value.length === 0) {
            phoneError.classList.remove("hidden");
            event.preventDefault();
            return false;
        }

        // Jika validasi berhasil, tampilkan pesan sukses
        event.preventDefault();
        document.getElementById("success-message").classList.remove("hidden");

        // Redirect setelah 3 detik
        setTimeout(() => {
        window.location.href = "{% url 'login' %}";
    }, 3000);


        return false;
    }
</script>


        <p class="text-center text-sm mt-4">
            Sudah punya akun? 
            <a href="{% url 'login' %}" class="text-blue-400 hover:text-blue-600 font-semibold">Login di sini</a>
        </p>
    </div>
    <footer class="w-full fixed bottom-0 bg-black bg-opacity-50 text-center py-4 text-lg sm:text-xl font-semibold text-white">
    <p>&copy; 2025 Sign Language Class. All rights reserved.</p>
</footer>
</body>
</html>